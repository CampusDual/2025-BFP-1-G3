<!-- == CONTENEDOR PRINCIPAL == -->
<div class="offers-container" >

  <!-- == FILTRO DE OFERTAS == -->
  <div class="search-bar">
    <input type="text" placeholder="Buscar oferta por título/descripción" [(ngModel)]="searchTerm"
      (input)="updateDisplayOffers()"/>
    <span id="iconSearch"><mat-icon>search</mat-icon></span>
  </div>

  <!-- Loading indicator -->
  <div *ngIf="isLoading" class="loading-container" id="loadMeesage">
    <mat-spinner diameter="40"></mat-spinner>
    <p>Cargando ofertas...</p>
  </div>

  <div class="cards-grid" *ngIf="!isLoading && filteredOffers && filteredOffers.length > 0; else noOffersOrSearch">
    <mat-card class="offer-card" *ngFor="let offer of filteredOffers">
      <mat-card-header>
        <div class="header-content">
          <mat-card-title>{{ offer.title }}</mat-card-title>
          <mat-card-subtitle>Empresa: <span class="company-name">{{ offer.companyName || 'Sin nombre'
              }}</span></mat-card-subtitle>
        </div>
      </mat-card-header>

      <mat-card-content>
        <p class="offer-description">{{ offer.offerDescription }}</p>

        <!-- Etiquetas técnicas -->
        <div class="tech-labels" *ngIf="offer.techLabels && offer.techLabels.length > 0">
          <div class="labels-container">
            <span *ngFor="let label of offer.techLabels" class="tech-chip">
              {{ label.name }}
            </span>
          </div>
        </div>
      </mat-card-content>

      <mat-card-actions class="card-actions">
        <button mat-icon-button matTooltip="Ver detalles de la oferta" class="tooltip-button"
          (click)="viewOfferDetails(offer.id)">
          <mat-icon id="info">info</mat-icon>
        </button>
        <button *ngIf="isCandidate()" mat-icon-button matTooltip="Inscribirse a la oferta"
          (click)="applyOffer(offer.id)" class="tooltip-button">
          <mat-icon id="apply">outbox</mat-icon>
        </button>
      </mat-card-actions>
    </mat-card>
  </div>
</div>

<!-- Mensaje aviso: No hay ofertas -->
<ng-template #noOffers>
  <div id="errorMessage">
    <mat-icon>info</mat-icon>
    <p>No hay ofertas disponibles en este momento</p>
  </div>
</ng-template>

<!-- Mensaje cuando el filtro no encuentra ofertas -->
<ng-template #noOffersSearch>
  <div class="no-offers" *ngIf="!isLoading">
    <mat-icon>info</mat-icon>
    <p>No se han encontrado resultados que cumplan los criterios de búsqueda</p>
  </div>
</ng-template>

<ng-template #noOffersOrSearch>
  <ng-container *ngIf="!isLoading && offers.length === 0; else noOffersSearch">
    <ng-container *ngTemplateOutlet="noOffers"></ng-container>
  </ng-container>
</ng-template>

<!-- Controles de paginación -->
<div class="pagination-container" *ngIf="!isLoading && !isSearchActive && totalPages > 1">
  <div class="pagination-info">
    <p>Total: {{ totalOffers }} ofertas</p>
  </div>
  <div class="pagination-controls">
    <button mat-button [disabled]="currentPage === 0" (click)="previousPage()">
      <mat-icon>navigate_before</mat-icon>
      Anterior
    </button>
    <span class="page-numbers">
      <span class="current-page">{{ currentPage + 1 }}</span> / {{ totalPages }}
    </span>
    <button mat-button [disabled]="currentPage >= totalPages - 1" (click)="nextPage()">
      Siguiente
      <mat-icon>navigate_next</mat-icon>
    </button>
  </div>
</div>
